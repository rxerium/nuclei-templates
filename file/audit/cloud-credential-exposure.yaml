id: cloud-credential-exposure

info:
  name: Cloud Provider Credential File Exposure
  author: rxerium
  severity: critical
  description: Detects exposed cloud provider configuration and credential files (.aws, .gcp, .azure) which contain authentication tokens and keys
  reference:
    - https://aws.amazon.com/blogs/security/aws-security-best-practices/
    - https://cloud.google.com/docs/authentication
    - https://learn.microsoft.com/en-us/azure/security/
  classification:
    cwe-id: CWE-798
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
  metadata:
    verified: true
    max-request: 1
  tags: file,cloud,credentials,exposure,audit,aws,gcp,azure,secrets

file:
  - extensions:
      - json
      - xml
      - yaml
      - yml
      - pem
      - key
      - txt
    matchers:
      - type: regex
        regex:
          - "^.*/(\\.aws|\\.gcp|\\.azure).*$"
          - "^.*/aws.*credentials.*$"
          - "^.*/gcp.*key.*$"
          - "^.*/azure.*credentials.*$"
          - "^.*/credentials\\.json$"
          - "^.*/service-account.*\\.json$"
        part: relative_path
    
    extractors:
      - type: regex
        name: cloud_cred_file
        regex:
          - "([^\n]+(?:\\.aws|\\.gcp|\\.azure|credentials|service-account)[^\n]*)"
        part: relative_path
